test_that("ranking.moments works", {
  
  
  data("edhec")
  AC_Moments <- ranking.moments(edhec,n=3, method  = "ac")
  
  AC_Moments_Correct <- list(mu = c(0.0056908736407871, -0.05, -0.0180001863195137, 0.05, 
              -0.0115976374615492, 0.0115976374615492, 6.93889390390723e-18, 
              -0.0253658377766107, 0.0347363718130141, 0.0253658377766107, 
              0.0180001863195137, -0.0347363718130141, -0.00569087364078709
  ), sigma = structure(c(0.00026559040132714, -7.69330590577306e-06, 
                         0.000201032692767087, 0.000311890348241539, 6.46718408759124e-05, 
                         0.000198010687458527, 0.000143562384339748, 9.41982197743862e-05, 
                         0.000194765927007299, 8.53928858659589e-05, 0.000156738977704048, 
                         -0.000267211118911745, 0.000161837543861977, -7.69330590577306e-06, 
                         0.000535625726609157, -8.0756901128069e-06, 3.03012660915727e-05, 
                         3.67656350364963e-05, 4.86889847378899e-06, 2.50466954213669e-06, 
                         0.000190615127405441, 4.7988795620438e-05, 7.01703052422031e-06, 
                         6.62395089581951e-06, 0.000123250426675514, 6.85600106171201e-05, 
                         0.000201032692767087, -8.0756901128069e-06, 0.000285105069674851, 
                         0.000422710091572661, 8.0021e-05, 0.000260322232913072, 0.000126009775713338, 
                         0.000130720668214997, 0.000258111642335766, 0.00010121804246848, 
                         0.000161986253483743, -0.000446242645653616, 0.000211383179163902, 
                         0.000311890348241539, 3.03012660915727e-05, 0.000422710091572661, 
                         0.00103173278354346, 0.000132705527007299, 0.000441427678168547, 
                         0.000194604441406768, 0.000305582443397478, 0.000515882204379562, 
                         0.000185138911081619, 0.000282135460783013, -0.000986749377040478, 
                         0.000419118592302588, 6.46718408759124e-05, 3.67656350364963e-05, 
                         8.0021e-05, 0.000132705527007299, 6.43943708029197e-05, 8.35776569343066e-05, 
                         3.71725897810219e-05, 6.5227597080292e-05, 0.000104992540145985, 
                         4.04012481751825e-05, 5.7748004379562e-05, -0.000116531728467153, 
                         8.49417547445255e-05, 0.000198010687458527, 4.86889847378899e-06, 
                         0.000260322232913072, 0.000441427678168547, 8.35776569343066e-05, 
                         0.000279170059721301, 0.000112351930325149, 0.000144118685467817, 
                         0.000295301459854015, 0.000127729644990046, 0.000170513923689449, 
                         -0.000509133380225614, 0.000227440167219642, 0.000143562384339748, 
                         2.50466954213669e-06, 0.000126009775713338, 0.000194604441406768, 
                         3.71725897810219e-05, 0.000112351930325149, 0.000128166528732581, 
                         6.95119275381553e-05, 0.000103368708029197, 4.04954153948242e-05, 
                         9.4243503384207e-05, -0.000104646536695421, 9.71922311877903e-05, 
                         9.41982197743862e-05, 0.000190615127405441, 0.000130720668214997, 
                         0.000305582443397478, 6.5227597080292e-05, 0.000144118685467817, 
                         6.95119275381553e-05, 0.000210468155806238, 0.000198483708029197, 
                         6.70211884538819e-05, 9.46472140676841e-05, -0.000241897841274054, 
                         0.000173613474054413, 0.000194765927007299, 4.7988795620438e-05, 
                         0.000258111642335766, 0.000515882204379562, 0.000104992540145985, 
                         0.000295301459854015, 0.000103368708029197, 0.000198483708029197, 
                         0.000393836569343066, 0.000136737919708029, 0.000188780554744526, 
                         -0.000670962065693431, 0.000280922875912409, 8.53928858659589e-05, 
                         7.01703052422031e-06, 0.00010121804246848, 0.000185138911081619, 
                         4.04012481751825e-05, 0.000127729644990046, 4.04954153948242e-05, 
                         6.70211884538819e-05, 0.000136737919708029, 8.94845454545455e-05, 
                         7.80912488387525e-05, -0.000222515577969476, 0.000104249232249502, 
                         0.000156738977704048, 6.62395089581951e-06, 0.000161986253483743, 
                         0.000282135460783013, 5.7748004379562e-05, 0.000170513923689449, 
                         9.4243503384207e-05, 9.46472140676841e-05, 0.000188780554744526, 
                         7.80912488387525e-05, 0.000128006093696085, -0.000292157188852024, 
                         0.00014427036881221, -0.000267211118911745, 0.000123250426675514, 
                         -0.000446242645653616, -0.000986749377040478, -0.000116531728467153,
                         -0.000509133380225614, -0.000104646536695421, -0.000241897841274054, 
                         -0.000670962065693431, -0.000222515577969476, -0.000292157188852024, 
                         0.00218470868135368, -0.000450748320106171, 0.000161837543861977, 
                         6.85600106171201e-05, 0.000211383179163902, 0.000419118592302588, 
                         8.49417547445255e-05, 0.000227440167219642, 9.71922311877903e-05, 
                         0.000173613474054413, 0.000280922875912409, 0.000104249232249502, 
                         0.00014427036881221, -0.000450748320106171, 0.000236285457996019
  ), .Dim = c(13L, 13L), .Dimnames = list(c("Convertible Arbitrage", 
                                            "CTA Global", "Distressed Securities", "Emerging Markets", "Equity Market Neutral", 
                                            "Event Driven", "Fixed Income Arbitrage", "Global Macro", "Long/Short Equity", 
                                            "Merger Arbitrage", "Relative Value", "Short Selling", "Funds of Funds"
  ), c("Convertible Arbitrage", "CTA Global", "Distressed Securities", 
       "Emerging Markets", "Equity Market Neutral", "Event Driven", 
       "Fixed Income Arbitrage", "Global Macro", "Long/Short Equity", 
       "Merger Arbitrage", "Relative Value", "Short Selling", "Funds of Funds"
  ))))
  
  expect_equal(AC_Moments, AC_Moments_Correct)
  
  
  
  meucci_Moments <- ranking.moments(edhec,n=3, method  = "meucci")
  
  
  meucci_Moments_correct <- list(mu = structure(c(0.00455031050698785, 0.00317759393734259, 
                        0.0046603466852508, 0.00545499626870485, 0.00411586245404177, 
                        0.00468060742668545, 0.00381040839033893, 0.00481425775791035, 
                        0.00494076441529383, 0.00487854336494494, 0.00485076197607472, 
                        0.00351856262100377, 0.00364899085782181), .Dim = c(13L, 1L), .Dimnames = list(
                          c("Convertible Arbitrage", "CTA Global", "Distressed Securities", 
                            "Emerging Markets", "Equity Market Neutral", "Event Driven", 
                            "Fixed Income Arbitrage", "Global Macro", "Long/Short Equity", 
                            "Merger Arbitrage", "Relative Value", "Short Selling", "Funds of Funds"
                          ), NULL)), sigma = structure(c(0.000266161055048137, -1.32395074776187e-05, 
                                                         0.000207129760731474, 0.000322539337534211, 6.8012169874841e-05, 
                                                         0.00020345679459984, 0.000144218137885118, 9.31772923358386e-05, 
                                                         0.000199040330769704, 9.27367395074042e-05, 0.000159896871394916, 
                                                         -0.000275733423586704, 0.000169539381271455, -1.32395074776187e-05, 
                                                         0.00054158768670333, -1.80312295673721e-05, 7.84150522310595e-06, 
                                                         3.31377674935818e-05, -5.49082783837003e-06, -2.1051635558856e-06, 
                                                         0.000186078360385374, 3.78199649177725e-05, -5.1949582701744e-07, 
                                                         1.45138280868505e-06, 0.000157298960164251, 6.00774471807608e-05, 
                                                         0.000207129760731474, -1.80312295673721e-05, 0.000297663471075916, 
                                                         0.00045461427648594, 8.9407956323626e-05, 0.000274636704362214, 
                                                         0.000128839604295096, 0.000138264664896988, 0.000273674118307171, 
                                                         0.000112115286821104, 0.00016980311716439, -0.000475732707972508, 
                                                         0.000228912753401848, 0.000322539337534211, 7.84150522310595e-06, 
                                                         0.00045461427648594, 0.00112175126740849, 0.000145632289876915, 
                                                         0.000474112299706608, 0.000202670150821892, 0.000330112339567432, 
                                                         0.00055465560436992, 0.00020603777835772, 0.000298399366164718, 
                                                         -0.00107696282894729, 0.000462077754109731, 6.8012169874841e-05, 
                                                         3.31377674935818e-05, 8.9407956323626e-05, 0.000145632289876915, 
                                                         7.09689914038932e-05, 9.04206173141622e-05, 3.98483887796735e-05, 
                                                         6.84732557828783e-05, 0.000111034262240143, 4.24744868742565e-05, 
                                                         6.17338353189332e-05, -0.000123361038487331, 9.06625503182245e-05, 
                                                         0.00020345679459984, -5.49082783837003e-06, 0.000274636704362214, 
                                                         0.000474112299706608, 9.04206173141622e-05, 0.000293860239758212, 
                                                         0.000114583729325179, 0.000150830060058045, 0.000309836353581965, 
                                                         0.000138180894347298, 0.000177434880574638, -0.000538538914066907, 
                                                         0.000243614358500118, 0.000144218137885118, -2.1051635558856e-06, 
                                                         0.000128839604295096, 0.000202670150821892, 3.98483887796735e-05, 
                                                         0.000114583729325179, 0.000127630441967058, 6.76620334775843e-05, 
                                                         0.000105924276719084, 4.40258635075753e-05, 9.61799922857033e-05, 
                                                         -0.00010891832684779, 0.000101531436240549, 9.31772923358386e-05, 
                                                         0.000186078360385374, 0.000138264664896988, 0.000330112339567432, 
                                                         6.84732557828783e-05, 0.000150830060058045, 6.76620334775843e-05, 
                                                         0.000221600956618782, 0.000210168174098781, 6.9666691342743e-05, 
                                                         9.70077163625891e-05, -0.000257859171573193, 0.000186565539878512, 
                                                         0.000199040330769704, 3.78199649177725e-05, 0.000273674118307171, 
                                                         0.00055465560436992, 0.000111034262240143, 0.000309836353581965, 
                                                         0.000105924276719084, 0.000210168174098781, 0.000412430400562134, 
                                                         0.000145304000876225, 0.000195019652631011, -0.000701351323782435, 
                                                         0.000301205290682182, 9.27367395074042e-05, -5.1949582701744e-07, 
                                                         0.000112115286821104, 0.00020603777835772, 4.24744868742565e-05, 
                                                         0.000138180894347298, 4.40258635075753e-05, 6.9666691342743e-05, 
                                                         0.000145304000876225, 9.66711446348984e-05, 8.3895398761711e-05, 
                                                         -0.000238382819418962, 0.000112669277410956, 0.000159896871394916, 
                                                         1.45138280868505e-06, 0.00016980311716439, 0.000298399366164718, 
                                                         6.17338353189332e-05, 0.000177434880574638, 9.61799922857033e-05, 
                                                         9.70077163625891e-05, 0.000195019652631011, 8.3895398761711e-05, 
                                                         0.000131988825471832, -0.00030262883850583, 0.00015286812740601, 
                                                         -0.000275733423586704, 0.000157298960164251, -0.000475732707972508, 
                                                         -0.00107696282894729, -0.000123361038487331, -0.000538538914066907, 
                                                         -0.00010891832684779, -0.000257859171573193, -0.000701351323782435, 
                                                         -0.000238382819418962, -0.00030262883850583, 0.00235278296737641, 
                                                         -0.000488584538547398, 0.000169539381271455, 6.00774471807608e-05, 
                                                         0.000228912753401848, 0.000462077754109731, 9.06625503182245e-05, 
                                                         0.000243614358500118, 0.000101531436240549, 0.000186565539878512, 
                                                         0.000301205290682182, 0.000112669277410956, 0.00015286812740601, 
                                                         -0.000488584538547398, 0.000256414046267692), .Dim = c(13L, 13L
                                                         ), .Dimnames = list(c("Convertible Arbitrage", "CTA Global", 
                                                                               "Distressed Securities", "Emerging Markets", "Equity Market Neutral", 
                                                                               "Event Driven", "Fixed Income Arbitrage", "Global Macro", "Long/Short Equity", 
                                                                               "Merger Arbitrage", "Relative Value", "Short Selling", "Funds of Funds"
                                                         ), c("Convertible Arbitrage", "CTA Global", "Distressed Securities", 
                                                              "Emerging Markets", "Equity Market Neutral", "Event Driven", 
                                                              "Fixed Income Arbitrage", "Global Macro", "Long/Short Equity", 
                                                              "Merger Arbitrage", "Relative Value", "Short Selling", "Funds of Funds"
                                                         ))))
  
  
  expect_equal(meucci_Moments, meucci_Moments_correct)
  
  
})
